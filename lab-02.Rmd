---
title: "Lab 02 - Plastic waste"
author: "Votre nom"
date: "La date"
output: github_document
---

## Chargement des packages et des données

```{r load-packages, message=FALSE}
library(tidyverse) 
```

```{r load-data, message=FALSE}
plastic_waste <- read_csv("data/plastic-waste.csv")
```

Commençons par filtrer les données pour retirer le point représenté par Trinité et Tobago (TTO) qui est un outlier.

```{r filter-data, message=FALSE}
plastic_waste <- plastic_waste %>%
  filter(plastic_waste_per_cap < 3.5)
```


## Exercices
```{r}
plastic_waste %>%
  filter(plastic_waste_per_cap > 3.5)
  ggplot(data = plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_histogram(binwidth = 0.2, fill = "green", color = "black") +
  labs(
    title = "Distribution des déchets plastiques par habitant (2010)",
    x = "Déchets plastiques par habitant (kg/jour ou tonne/an ?)",
    y = "Nombre de pays") +
  theme_minimal()
```

### Exercise 1

```{r plastic-waste-continent}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap)) +
  geom_histogram(binwidth = 0.2, fill = "green", color = "black") +
  facet_wrap(~ continent) +
  labs(
    title = "Distribution des déchets plastiques par habitant (2010)",
    x = "Déchets plastiques par habitant (kg/jour)",
    y = "Nombre de pays"
  ) +
  theme_minimal()

```

### Exercise 2

```{r plastic-waste-density}
library(ggplot2)

# Graphique de densité avec couleurs par continent
ggplot(plastic_waste, aes(x = plastic_waste_per_cap, fill = continent, color = continent)) +
  geom_density(alpha = 0.4) +
  labs(
    title = "Distribution des déchets plastiques par habitant (2010)",
    x = "Déchets plastiques par habitant (kg/jour)",
    y = "Densité"
  ) +
  theme_minimal()

```

Dans ggplot, il faut différencier les esthétiques qui dépendent des données (aes()) des paramètres fixes qui sont indépendants des données (argument direct de la géométrie).Par exemple, la couleur (contour ou remplissage) doit changer en fonction des variables, donc cela se fait avec aes(). À l'inverse, la transparence est la même pour toutes les courbes, donc cela se fait par geom_density().

### Exercise 3

Boxplot:

```{r plastic-waste-boxplot}
ggplot(plastic_waste, aes(x = continent, y = plastic_waste_per_cap)) +
  geom_boxplot(alpha = 0.6) +
  labs(
    title = "Déchets plastiques par habitant (2010)",
    x = "Continent",
    y = "Déchets plastiques par habitant (kg/jour)"
  ) +
  theme_minimal() +
  theme(legend.position = "none")


```

Violin plot:

```{r plastic-waste-violin}
ggplot(plastic_waste, aes(x = continent, y = plastic_waste_per_cap)) +
  geom_violin(alpha = 0.6, trim = FALSE) +
  labs(
    title = "Déchets plastiques par habitant (2010)",
    x = "Continent",
    y = "Déchets plastiques par habitant (kg/jour)"
  ) +
  theme_minimal() +
  theme(legend.position = "none")

```

Les Boxplot montrent la médiane, l'étendue interquartile et les outliers, mais cela ils ne montrent pas la forme des distributions à l'intérieur. Pour les Violoin plot, cela permet de voir la symétrie, les différents pics et la concentration dans certaines zones.

### Exercise 4


```{r plastic-waste-mismanaged}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap, 
                          y = mismanaged_plastic_waste_per_cap, 
                          color = continent)) +
  geom_point(size = 3, alpha = 0.7) +
  labs(
    title = "Relation entre déchets plastiques générés et mal gérés (2010)",
    x = "Déchets plastiques par habitant (kg/jour)",
    y = "Déchets plastiques mal gérés par habitant (kg/jour)",
    color = "Continent"
  ) +
  theme_minimal()

```

Oui, il y a une tendance. Plus un pays génère de déchets plastiques par habitant, plus la quantité de déchets mal gérés par habitant a tendance à augmenter. Ce n'est pas uniforme, car certains continents ont des systèmes de gestion des déchets plus efficaces, mais plus de déchets comme l'Europe et l'Amérique du Nord. Dans le cas de l'Asie et l'Afrique, il y a moins de déchets, mais leur gestion des déchets est beaucoup moins bien géré. Pour l'Océanie et l'Amérique du Sud, ils sont plutôt intermédiaires.

### Exercise 5


```{r plastic-waste-population-total}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap, 
                          y = total_pop, 
                          color = continent)) +
  geom_point(size = 3, alpha = 0.7) +
  scale_y_log10(labels = scales::comma) +
  labs(
    title = "Déchets plastiques par habitant vs population totale (2010)",
    x = "Déchets plastiques par habitant (kg/jour)",
    y = "Population totale (log10)",
    color = "Continent"
  ) +
  theme_minimal()

```

```{r plastic-waste-population-coastal}
ggplot(plastic_waste, aes(x = plastic_waste_per_cap,
                                y = coastal_pop,
                                color = continent)) +
  geom_point(size = 3, alpha = 0.7) +
  scale_y_log10(labels = scales::comma) +
  labs(
    title = "Déchets plastiques par habitant vs population côtière (2010)",
    x = "Déchets plastiques par habitant (kg/jour)",
    y = "Population côtière (log10)",
    color = "Continent"
  ) +
  theme_minimal()

```

Il y a une relation plus faible entre le nombre de déchets par habitant et la population totale.Par contre, il y a une relation plus pertinente et visible entre le nombre de déchets par habitant et la population côtière, car cette variable est directement liée au risque de pollution marine.

## Conclusion

Recréez la visualisation:

```{r recreate-viz}
library(ggplot2)
library(dplyr)

# Préparation des données
plastic_waste_coastal <- plastic_waste %>% 
  mutate(coastal_pop_prop = coastal_pop / total_pop) %>% 
  filter(plastic_waste_per_cap < 3)

# Graphe
ggplot(plastic_waste_coastal, aes(x = coastal_pop_prop, 
                                  y = plastic_waste_per_cap, 
                                  color = continent)) +
  geom_point(alpha = 0.7, size = 2) +
  geom_smooth(method = "loess", se = TRUE, color = "black") +
  labs(
    title = "Quantité de déchets plastiques vs Proportion de la population côtière",
    subtitle = "Selon le continent",
    x = "Proportion de la population côtière (Coastal / total population)",
    y = "Nombre de déchets plastiques par habitant",
    color = "Continent"
  ) +
  theme_minimal()

```

Interprétation : La consommation de plastique par habitant est davantage liée au développement économique qu’à la géographie (proportion côtière).La proportion côtière reste un facteur de vulnérabilité environnementale : même si la consommation de plastique n’est pas la plus élevée, les pays où une grande partie de la population vit près des côtes présentent un risque accru que les déchets plastiques finissent directement dans l’océan.Ainsi, ce graphe illustre bien que la pollution plastique marine est un problème combinant facteurs économiques et géographiques.